FROM node:lts

ARG POSTGRES_HOSTPORT
ARG POSTGRES_HOST
ARG POSTGRES_PORT
ARG POSTGRES_USERNAME
ARG POSTGRES_PASSWORD
ARG POSTGRES_DATABASE
ARG POSTGRES_SYNCHRONIZE
ARG JWT_SECRET_KEY
ARG JWT_EXPIRES_ACCESS
ARG CUR_VERSION
ARG BACK_DOMAIN
ARG FRONT_URL
ARG COOKIE_SECURE

ENV POSTGRES_HOSTPORT=$POSTGRES_HOSTPORT
ENV POSTGRES_HOST=$POSTGRES_HOST
ENV POSTGRES_PORT=$POSTGRES_PORT
ENV POSTGRES_USERNAME=$POSTGRES_USERNAME
ENV POSTGRES_PASSWORD=$POSTGRES_PASSWORD
ENV POSTGRES_DATABASE=$POSTGRES_DATABASE
ENV POSTGRES_SYNCHRONIZE=$POSTGRES_SYNCHRONIZE
ENV JWT_SECRET_KEY=$JWT_SECRET_KEY
ENV JWT_EXPIRES_ACCESS=$JWT_EXPIRES_ACCESS
ENV CUR_VERSION=$CUR_VERSION
ENV BACK_DOMAIN=$BACK_DOMAIN
ENV FRONT_URL=$FRONT_URL
ENV COOKIE_SECURE=$COOKIE_SECURE

WORKDIR /app

COPY ./package.json ./

RUN npm install

COPY . .

EXPOSE 3002

CMD ["npm", "run", "start"]
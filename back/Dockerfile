FROM node:lts

ARG POSTGRES_HOSTPORT
ARG POSTGRES_HOST
ARG POSTGRES_PORT
ARG POSTGRES_USERNAME
ARG POSTGRES_PASSWORD
ARG POSTGRES_DATABASE
ARG POSTGRES_SYNCHRONIZE
ARG JWT_SECRET_KEY
ARG JWT_EXPIRES_ACCESS
ARG CUR_VERSION
ARG FRONT_URL
ARG COOKIE_SAMESITE
ARG WEATHER_URL
ARG WEATHER_KEY
ARG PROJ_KOREA

ENV POSTGRES_HOSTPORT=$POSTGRES_HOSTPORT
ENV POSTGRES_HOST=$POSTGRES_HOST
ENV POSTGRES_PORT=$POSTGRES_PORT
ENV POSTGRES_USERNAME=$POSTGRES_USERNAME
ENV POSTGRES_PASSWORD=$POSTGRES_PASSWORD
ENV POSTGRES_DATABASE=$POSTGRES_DATABASE
ENV POSTGRES_SYNCHRONIZE=$POSTGRES_SYNCHRONIZE
ENV JWT_SECRET_KEY=$JWT_SECRET_KEY
ENV JWT_EXPIRES_ACCESS=$JWT_EXPIRES_ACCESS
ENV CUR_VERSION=$CUR_VERSION
ENV FRONT_URL=$FRONT_URL
ENV COOKIE_SAMESITE=$COOKIE_SAMESITE
ENV COOKIE_DOMAIN=$COOKIE_DOMAIN
ENV WEATHER_URL=$WEATHER_URL
ENV WEATHER_KEY=$WEATHER_KEY
ENV PROJ_KOREA=$PROJ_KOREA

WORKDIR /app

COPY ./package.json ./

RUN npm install

COPY . .

EXPOSE 3002

CMD ["npm", "run", "start"]